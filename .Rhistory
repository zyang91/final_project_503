install.packages("exactextractr")
library(sf)
library(tidyverse)
library(raster)
library(exactextractr)
heat<- "C:/Users/zyang/OneDrive/desktop/final_project_503/data/heat.tif"
heat_raster <- raster(heat)
plot(heat_raster)
library(tidycensus)
NYC_pop<- get_acs(geography = "tract",
variables = "B01001_001",
state = "NY",
county = c("New York", "Kings", "Queens", "Bronx", "Richmond"),
survey= "acs5",
output= "wide",
geometry = TRUE,
year = 2022)
st_crs(NYC_pop)<- st_crs(heat_raster)
NYC_pop <- st_transform(NYC_pop, st_crs(heat_raster))
#check
st_crs(NYC_pop) == st_crs(heat_raster)
extract_values<-exact_extract(heat_raster, NYC_pop, fun = "mean")
st_is_valid(NYC_pop)
extract_values<-exact_extract(heat_raster, NYC_pop, fun = "mean")
heat<- "C:/Users/zyang/Downloads/LC08_L2SP_013032_20240827_20240831_02_T1_ST_B10.TIF"
heat_raster <- raster(heat)
plot(heat_raster)
NYC_pop <- st_transform(NYC_pop, st_crs(heat_raster))
st_crs(NYC_pop) == st_crs(heat_raster)
extract_values<-exact_extract(heat_raster, NYC_pop, fun = "mean")
NYC <- st_make_valid(NYC_pop)
extract_values<-exact_extract(heat_raster, NYC, fun = "mean")
extract_values<-exact_extract(heat_raster, NYC_pop, fun = "mean")
View(NYC)
census<- st_read("C:/Users/zyang/OneDrive/desktop/final_project_503/data/nyct2020_24d/nyct2020.shp")
NYC_pop <- st_transform(NYC_pop, st_crs(heat_raster))
census <- st_transform(NYC_pop, st_crs(heat_raster))
#check
st_crs(NYC_pop) == st_crs(heat_raster)
View(census)
extract_values<-exact_extract(heat_raster, NYC_pop, fun = "mean")
extent(heat_raster)
extract_values<-exact_extract(heat_raster, census, fun = "mean")
#check
plot(census)
census <- st_transform(census, st_crs(heat_raster))
extract_values<-exact_extract(heat_raster, census, fun = "mean")
library(tidyverse)
library(sf)
library(raster)
library(tidycensus)
library(exactextractr)
heat<- "C:/Users/zyang/Downloads/LC08_L2SP_013032_20240827_20240831_02_T1_ST_B10.TIF"
heat_raster <- raster(heat)
plot(heat_raster)
census<- st_read("C:/Users/zyang/OneDrive/desktop/final_project_503/data/nyct2020_24d/nyct2020.shp")
st_transform(census, st_crs(heat_raster))
extract_values<-exact_extract(heat_raster, census, fun = "mean")
census$heat <- extract_values
View(census)
acsVariables <- c(totpop = "B01001_001",
asian = "B03002_006", #Asian Non Hispanic alone,
black = "B03002_004", #Black non-Hispanic alone
hisp_latx = "B03003_003", #Hispanic/Latine
white = "B03002_003", #White Non-Hispanic
medInc = "B19013_001",
poverty_rate = "B17001_002E" )
mc_2022<- get_acs(geography = "tract",
variables = acsVariables,
state = "NY",
county = c("New York", "Kings", "Queens", "Bronx", "Richmond"),
survey= "acs5",
output= "wide",
geometry = TRUE,
year = 2022)
nyc_tract_data <- mc_2022%>%
mutate(poverty_rate_percentage= (poverty_rate/totpopE)*100)%>%
select(GEOID, totpopE, asianE, blackE, hisp_latxE, whiteE, medIncE, poverty_rate, poverty_rate_percentage, geometry)
nyc_tract_data <- mc_2022%>%
mutate(poverty_rate_percentage= (poverty_rate/totpopE)*100)%>%
dplyr::select(GEOID, totpopE, asianE, blackE, hisp_latxE, whiteE, medIncE, poverty_rate, poverty_rate_percentage, geometry)
nyc_tract_data <- mc_2022%>%
mutate(poverty_rate_percentage= (poverty_rate/totpopE)*100)%>%
dplyr::select(GEOID, totpopE, asianE, blackE, hisp_latxE, whiteE, medIncE, poverty_rate, poverty_rate_percentage)
View(nyc_tract_data)
View(census)
complete<-left_join(census, nyc_tract_data, by = c("GEOID" = "GEOID"))
complete<-st_join(census, nyc_tract_data, by = c("GEOID" = "GEOID"))
st_transform(nyc_tract_data, st_crs(census))
acsVariables <- c(totpop = "B01001_001",
asian = "B03002_006", #Asian Non Hispanic alone,
black = "B03002_004", #Black non-Hispanic alone
hisp_latx = "B03003_003", #Hispanic/Latine
white = "B03002_003", #White Non-Hispanic
medInc = "B19013_001",
poverty_rate = "B17001_002E" )
mc_2022<- get_acs(geography = "tract",
variables = acsVariables,
state = "NY",
county = c("New York", "Kings", "Queens", "Bronx", "Richmond"),
survey= "acs5",
output= "wide",
geometry = FALSE,
year = 2022)
nyc_tract_data <- mc_2022%>%
mutate(poverty_rate_percentage= (poverty_rate/totpopE)*100)%>%
dplyr::select(GEOID, totpopE, asianE, blackE, hisp_latxE, whiteE, medIncE, poverty_rate, poverty_rate_percentage)
View(nyc_tract_data)
complete<-left_join(census, nyc_tract_data, by = c("GEOID" = "GEOID"))
View(census)
complete<-complete%>%
dplyr::select(GEOID, heat, totpopE, asianE, blackE, hisp_latxE, whiteE, medIncE, poverty_rate, poverty_rate_percentage)
write.csv(complete, "C:/Users/zyang/OneDrive/desktop/final_project_503/complete.csv")
st_write(complete, "C:/Users/zyang/OneDrive/desktop/final_project_503/complete.gpkg")
library(tidyverse)
setwd("C:/Users/zyang/OneDrive/desktop/final_project_503")
# read in the data
data <- read_csv("complete.csv")
View(data)
ggplot(complete,aes(x=totpopE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Total Population vs Heat",x="Total Population",y="Heat")+
theme_minimal()
ggplot(complete,aes(x=medincE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Median Income vs Heat",x="Median Income",y="Heat")+
theme_minimal()
View(complete)
View(complete)
ggplot(complete,aes(x=medIncE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Median Income vs Heat",x="Median Income",y="Heat")+
theme_minimal()
View(complete)
View(complete)
ggplot(complete,aes(x=poverty_rate_percentage,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Poverty Rate vs Heat",x="Poverty Rate",y="Heat")+
theme_minimal()
View(complete)
ggplot(complete,aes(x=asianE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Asian Population vs Heat",x="Asian Population",y="Heat")+
theme_minimal()
ggplot(complete,aes(x=blackE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Black Population vs Heat",x="Black Population",y="Heat")+
theme_minimal()
View(census)
View(complete)
View(complete)
ggplot(complete,aes(x=hisp_latxE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="Hispanic/Latine Population vs Heat",x="Hispanic/Latine Population",y="Heat")+
theme_minimal()
ggplot(complete,aes(x=whiteE,y=heat))+
geom_point()+
geom_smooth(method="lm",se=FALSE)+
labs(title="White Population vs Heat",x="White Population",y="Heat")+
theme_minimal()
View(complete)
View(complete)
View(census)
## model with racial + income
model1<-lm(heat~asianE+medIncE, data=complete)
summary(model1)
model1_1<-lm(heat~asianE+poverty_rate_percentageE, data=complete)
model1_1<-lm(heat~asianE+poverty_rate_percentage, data=complete)
summary(model1_1)
model2<-lm(heat~blackE+medIncE, data=complete)
summary(model2)
odel2_1<-lm(heat~blackE+poverty_rate_percentage, data=complete)
summary(model2_1)
model2_1<-lm(heat~blackE+poverty_rate_percentage, data=complete)
summary(model2_1)
model3<-lm(heat~hisp_latxE+medIncE, data=complete)
summary(model3)
model3_1<-lm(heat~hisp_latxE+poverty_rate_percentage, data=complete)
summary(model3_1)
model4<-lm(heat~whiteE+medIncE, data=complete)
summary(model4)
model4_1<-lm(heat~whiteE+poverty_rate_percentage, data=complete)
summary(model4_1)
